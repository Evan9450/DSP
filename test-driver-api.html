<!DOCTYPE html>
<html>
<head>
    <title>Test Driver API</title>
</head>
<body>
    <h1>Test Driver API</h1>
    <button onclick="testDriverAPI()">Test Driver API</button>
    <pre id="result"></pre>

    <script>
        async function testDriverAPI() {
            const resultEl = document.getElementById('result');
            resultEl.textContent = 'Testing...';

            // Get token from localStorage
            const token = localStorage.getItem('admin_token');

            if (!token) {
                resultEl.textContent = 'ERROR: No token found in localStorage!\nPlease login first.';
                return;
            }

            console.log('Token:', token);

            try {
                const response = await fetch('http://localhost:8000/api/v1/drivers/', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);

                const text = await response.text();
                console.log('Response text:', text);

                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    data = text;
                }

                resultEl.textContent = JSON.stringify({
                    status: response.status,
                    statusText: response.statusText,
                    ok: response.ok,
                    data: data
                }, null, 2);

            } catch (error) {
                console.error('Error:', error);
                resultEl.textContent = 'ERROR: ' + error.message + '\n\n' + error.stack;
            }
        }
    </script>
</body>
</html>
